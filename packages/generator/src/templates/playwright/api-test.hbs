// Generated by SpecForge — do not edit manually
// API tests for {{modelName}} ({{endpoint.path}})

import { test, expect } from "@playwright/test";
{{#if hasAuth}}
import { getAuthHeaders } from "../auth-setup";
{{/if}}

const BASE_PATH = "{{endpoint.path}}";

test.describe("{{modelName}} API ({{endpoint.path}})", () => {
{{#if hasAuth}}
  let headers: Record<string, string>;

  test.beforeAll(async ({ request }) => {
    headers = await getAuthHeaders(request, "{{defaultAuthLevel}}");
  });

{{/if}}
{{#if (includes actions "list")}}
  test("GET {{endpoint.path}} — list all {{pluralize (lowercase modelName)}}", async ({ request }) => {
    const response = await request.get(BASE_PATH{{#if authList}}, { headers }{{/if}});

    expect(response.ok()).toBeTruthy();
    expect(response.status()).toBe(200);
    const body = await response.json();
    expect(Array.isArray(body.data ?? body)).toBeTruthy();
  });

{{/if}}
{{#if (includes actions "get")}}
  test("GET {{endpoint.path}}/:id — get a single {{lowercase modelName}}", async ({ request }) => {
    // TODO: Replace with a valid ID from your test data
    const id = "test-id";
    const response = await request.get(`${BASE_PATH}/${id}`{{#if authGet}}, { headers }{{/if}});

    expect(response.status()).toBe(200);
    const body = await response.json();
    expect(body.data ?? body).toBeDefined();
  });

{{/if}}
{{#if (includes actions "create")}}
  test("POST {{endpoint.path}} — create a {{lowercase modelName}}", async ({ request }) => {
    const response = await request.post(BASE_PATH, {
{{#if authCreate}}
      headers,
{{/if}}
      data: {{{json sampleData}}},
    });

    expect(response.status()).toBe(201);
    const body = await response.json();
    expect(body.data ?? body).toBeDefined();
{{#each requiredFields}}
    expect((body.data ?? body).{{this.name}}).toBeDefined();
{{/each}}
  });

{{/if}}
{{#if (includes actions "update")}}
  test("PUT {{endpoint.path}}/:id — update a {{lowercase modelName}}", async ({ request }) => {
    const id = "test-id";
    const response = await request.put(`${BASE_PATH}/${id}`, {
{{#if authUpdate}}
      headers,
{{/if}}
      data: {{{json updateData}}},
    });

    expect(response.ok()).toBeTruthy();
    const body = await response.json();
    expect(body.data ?? body).toBeDefined();
  });

{{/if}}
{{#if (includes actions "delete")}}
  test("DELETE {{endpoint.path}}/:id — delete a {{lowercase modelName}}", async ({ request }) => {
    const id = "test-id";
    const response = await request.delete(`${BASE_PATH}/${id}`{{#if authDelete}}, { headers }{{/if}});

    expect(response.status()).toBe(204);
  });

{{/if}}
});
