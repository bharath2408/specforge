// Generated by SpecForge â€” do not edit manually
// Authentication setup for E2E tests

import type { APIRequestContext } from "@playwright/test";

export type AuthRole = "public" | "authenticated" | "admin" | "owner";

interface AuthCredentials {
  email: string;
  password: string;
}

const CREDENTIALS: Record<Exclude<AuthRole, "public">, AuthCredentials> = {
  authenticated: {
    email: "testuser@example.com",
    password: "test-password-123",
  },
  admin: {
    email: "admin@example.com",
    password: "admin-password-123",
  },
  owner: {
    email: "owner@example.com",
    password: "owner-password-123",
  },
};

/**
 * Log in as the given role and return the auth token.
 */
export async function login(
  request: APIRequestContext,
  role: Exclude<AuthRole, "public"> = "authenticated"
): Promise<string> {
  const creds = CREDENTIALS[role];

  const response = await request.post("{{authEndpoint}}", {
    data: creds,
  });

  if (!response.ok()) {
    throw new Error(`Login failed for role "${role}": ${response.status()}`);
  }

  const body = await response.json();
  return body.token ?? body.accessToken ?? body.access_token;
}

/**
 * Get authorization headers for the given role.
 */
export async function getAuthHeaders(
  request: APIRequestContext,
  role: AuthRole = "authenticated"
): Promise<Record<string, string>> {
  if (role === "public") return {};

  const token = await login(request, role);
  return {
    Authorization: `Bearer ${token}`,
  };
}
