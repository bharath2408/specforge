// Generated by SpecForge â€” do not edit manually
// Authentication middleware ({{strategy}})

import type { FastifyRequest, FastifyReply } from "fastify";

export interface AuthUser {
  id: string;
  role: "public" | "authenticated" | "admin" | "owner";
}

/**
 * JWT authentication guard.
 */
export async function authGuard(
  request: FastifyRequest,
  reply: FastifyReply
): Promise<void> {
  const authHeader = request.headers.authorization;

  if (!authHeader || !authHeader.startsWith("Bearer ")) {
    reply.status(401).send({
      error: "Unauthorized",
      message: "Missing or invalid Authorization header",
    });
    return;
  }

  const token = authHeader.substring(7);
  // TODO: Implement actual token verification
}
